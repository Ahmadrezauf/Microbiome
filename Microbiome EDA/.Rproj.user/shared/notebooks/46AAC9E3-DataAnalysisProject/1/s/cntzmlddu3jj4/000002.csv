"0","NormalizeL2Sqr <- function(iData){"
"0","  require(dplyr)"
"0","  "
"0","  sqrData <- sqrt(iData)"
"0","  sqrData <- as.data.frame(sqrData)"
"0","  "
"0","  iData %>% "
"0","    colSums(na.rm = T) %>% "
"0","    sqrt() -> sampleSum"
"0","  "
"0","  if(length(which(sampleSum == 0)) != 0){"
"0","    sqrData <- sqrData[,-which(sampleSum == 0)] # removing rows that their sum is zero!   "
"0","    sampleSum <- sampleSum[-which(sampleSum == 0)]"
"0","    warning(""Some samples counts values are zero"")"
"0","  }"
"0","  "
"0","  # removing genes that are not expressed!"
"0","  # What should I do??? ***"
"0","  "
"0","  "
"0","  # Too slow!"
"0","  # sqrData <- apply(sqrData , 2 , function(x) x/sqrt(sum(x^2)))"
"0","  if(ncol(sqrData) == 0){"
"0","   stop(""All of the microbes's count in samples is zero"") "
"0","  }"
"0","  else{"
"0","    tmp <- lapply(1:ncol(sqrData) , function(i) sqrData[,i] <<- (sqrData[,i]/sampleSum[i]))"
"0","    remove(tmp)"
"0","    sqrData"
"0","  }"
"0","}"
